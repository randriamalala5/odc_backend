<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tableau de bord</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h2 class="mb-4">ðŸ‘¤ Profil utilisateur</h2>
    <div id="profil" class="card p-3 shadow-sm"></div>
    <button class="btn btn-secondary mt-3" onclick="logout()">Se dÃ©connecter</button>
  </div>

  <script>
    async function fetchProfile() {
      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = 'login.html';
        return;
      }

      try {
        const res = await fetch('https://localhost:3000/api/users/profile', {
          headers: { Authorization: `Bearer ${token}` }
        });

        const data = await res.json();

        if (res.ok) {
          const user = data.profil;
          document.getElementById('profil').innerHTML = `
            <p><strong>Nom :</strong> ${user.utl_nom}</p>
            <p><strong>PrÃ©nom :</strong> ${user.utl_prenom}</p>
            <p><strong>Email :</strong> ${user.utl_email}</p>
            <p><strongTÃ©lÃ©phone :</strong> ${user.utl_number}</p>
          `;
        } else {
          document.getElementById('profil').textContent = data.error || 'Erreur de chargement';
        }
      } catch (err) {
        document.getElementById('profil').textContent = 'Erreur serveur';
      }
    }

    function logout() {
      localStorage.removeItem('token');
      window.location.href = 'auth.html';
    }

    fetchProfile();
  </script>
</body>
</html>
